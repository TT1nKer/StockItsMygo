# ç­–ç•¥ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“š ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [å†…ç½®ç­–ç•¥](#å†…ç½®ç­–ç•¥)
3. [ä½¿ç”¨ç­–ç•¥](#ä½¿ç”¨ç­–ç•¥)
4. [è‡ªå®šä¹‰ç­–ç•¥](#è‡ªå®šä¹‰ç­–ç•¥)
5. [ç­–ç•¥ç»„åˆ](#ç­–ç•¥ç»„åˆ)
6. [ç­–ç•¥æ¯”è¾ƒ](#ç­–ç•¥æ¯”è¾ƒ)
7. [é«˜çº§ç”¨æ³•](#é«˜çº§ç”¨æ³•)

---

## æ¦‚è¿°

ç­–ç•¥ç³»ç»Ÿæä¾›äº†æ¨¡å—åŒ–ã€å¯æ’æ‹”çš„äº¤æ˜“ç­–ç•¥æ¡†æ¶ï¼Œè®©ä½ å¯ä»¥ï¼š

âœ… **ä½¿ç”¨å†…ç½®ç­–ç•¥** - 3ç§ç»è¿‡éªŒè¯çš„ç­–ç•¥
âœ… **è‡ªå®šä¹‰ç­–ç•¥** - ç”¨Pythonç¼–å†™è‡ªå·±çš„äº¤æ˜“é€»è¾‘
âœ… **ç­–ç•¥ç»„åˆ** - ç»„åˆå¤šä¸ªç­–ç•¥ï¼Œç»¼åˆåˆ¤æ–­
âœ… **ç­–ç•¥æ¯”è¾ƒ** - æ¯”è¾ƒä¸åŒç­–ç•¥çš„è¡¨ç°
âœ… **çµæ´»åˆ‡æ¢** - æ ¹æ®å¸‚åœºæƒ…å†µåˆ‡æ¢ç­–ç•¥

### æ ¸å¿ƒç†å¿µ

æ¯ä¸ªç­–ç•¥éƒ½æ˜¯ç‹¬ç«‹çš„Pythonç±»ï¼Œå®ç°ç»Ÿä¸€çš„æ¥å£ï¼š

```python
class MyStrategy(BaseStrategy):
    def analyze(self, symbol, df=None):
        # ä½ çš„äº¤æ˜“é€»è¾‘
        return {
            'symbol': symbol,
            'signal': 'BUY',  # æˆ– 'SELL', 'HOLD', 'STRONG_BUY', 'STRONG_SELL'
            'score': 75,      # 0-100
            'reasons': [...],
            'entry_price': 150.00,
            'stop_loss': 142.50,
            'take_profit': 168.00,
            ...
        }
```

---

## å†…ç½®ç­–ç•¥

### 1. åŠ¨é‡ç­–ç•¥ (Momentum Strategy)

**é€‚ç”¨åœºæ™¯**: è¶‹åŠ¿è¡Œæƒ…ï¼Œç‰›å¸‚
**æ ¸å¿ƒé€»è¾‘**: ä¹°å…¥è¿‘æœŸæ¶¨å¹…å¤§ã€æˆäº¤é‡æ”¾å¤§çš„å¼ºåŠ¿è‚¡

**å…³é”®æŒ‡æ ‡**:
- 20æ—¥ä»·æ ¼åŠ¨é‡ (>10%)
- æˆäº¤é‡æ”¾å¤§ (>1.5å€)
- çªç ´è¿‘æœŸé«˜ç‚¹
- ä»·æ ¼vs MA20ä½ç½®

**å‚æ•°**:
```python
{
    'lookback_days': 20,        # å›çœ‹å¤©æ•°
    'min_momentum': 10.0,       # æœ€ä½åŠ¨é‡(%)
    'volume_multiplier': 1.5,   # æˆäº¤é‡å€æ•°
    'capital': 2000,
    'position_pct': 0.35,
    'stop_loss_pct': 0.05,
    'take_profit_pct': 0.12
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from script.strategies.momentum import MomentumStrategy

strategy = MomentumStrategy()
signal = strategy.analyze('AAPL')

# è‡ªå®šä¹‰å‚æ•°
custom_strategy = MomentumStrategy(params={
    'lookback_days': 30,
    'min_momentum': 15.0
})
```

**ä¼˜åŠ¿**:
- âœ… è¶‹åŠ¿è·Ÿéšï¼ŒæŠ“ä½å¼ºåŠ¿è‚¡
- âœ… æˆäº¤é‡ç¡®è®¤ï¼Œé¿å…å‡çªç ´
- âœ… æ˜ç¡®æ­¢ç›ˆæ­¢æŸ

**åŠ£åŠ¿**:
- âŒ éœ‡è¡å¸‚è¡¨ç°å·®
- âŒ å¯èƒ½è¿½é«˜
- âŒ è¶‹åŠ¿åè½¬æ—¶äºæŸ

---

### 2. å‡å€¼å›å½’ç­–ç•¥ (Mean Reversion Strategy)

**é€‚ç”¨åœºæ™¯**: éœ‡è¡è¡Œæƒ…ï¼Œç®±ä½“æ•´ç†
**æ ¸å¿ƒé€»è¾‘**: ä¹°å…¥çŸ­æœŸè¶…å–ã€è¿œç¦»å‡çº¿çš„è‚¡ç¥¨ï¼Œç­‰å¾…å›å½’

**å…³é”®æŒ‡æ ‡**:
- RSI (è¶…å–<30)
- å¸ƒæ—å¸¦ä½ç½® (æ¥è¿‘ä¸‹è½¨)
- è·ç¦»MA20åç¦»åº¦
- è¿‘æœŸè·Œå¹…

**å‚æ•°**:
```python
{
    'rsi_period': 14,
    'rsi_oversold': 30,
    'rsi_overbought': 70,
    'bb_period': 20,
    'bb_std': 2,
    'capital': 2000,
    'position_pct': 0.35,
    'stop_loss_pct': 0.05,
    'take_profit_pct': 0.10
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from script.strategies.mean_reversion import MeanReversionStrategy

strategy = MeanReversionStrategy()
signal = strategy.analyze('AAPL')
```

**ä¼˜åŠ¿**:
- âœ… éœ‡è¡å¸‚è¡¨ç°å¥½
- âœ… ä¹°åœ¨ä½ç‚¹
- âœ… èƒœç‡è¾ƒé«˜

**åŠ£åŠ¿**:
- âŒ è¶‹åŠ¿å¸‚è¡¨ç°å·®
- âŒ å¯èƒ½æŠ„åº•å¤±è´¥
- âŒ éœ€è¦è€å¿ƒç­‰å¾…

---

### 3. çªç ´ç­–ç•¥ (Breakout Strategy)

**é€‚ç”¨åœºæ™¯**: ç›˜æ•´åçªç ´ï¼Œå…³é”®é˜»åŠ›ä½çªç ´
**æ ¸å¿ƒé€»è¾‘**: ä¹°å…¥çªç ´ç›˜æ•´åŒºé—´æˆ–å…³é”®é˜»åŠ›ä½çš„è‚¡ç¥¨

**å…³é”®æŒ‡æ ‡**:
- ç›˜æ•´æ£€æµ‹ (æ³¢åŠ¨<10%)
- çªç ´ç¡®è®¤ (çªç ´>2%)
- æˆäº¤é‡ç¡®è®¤ (>1.5å€)
- ATR (æ³¢åŠ¨ç‡)

**å‚æ•°**:
```python
{
    'consolidation_days': 20,
    'breakout_threshold': 1.02,
    'volume_confirmation': True,
    'min_volume_ratio': 1.5,
    'atr_period': 14,
    'capital': 2000,
    'position_pct': 0.35,
    'stop_loss_atr_multiplier': 2.0,
    'take_profit_pct': 0.15
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from script.strategies.breakout import BreakoutStrategy

strategy = BreakoutStrategy()
signal = strategy.analyze('AAPL')
```

**ä¼˜åŠ¿**:
- âœ… æŠ“ä½æ–°è¶‹åŠ¿èµ·ç‚¹
- âœ… é£é™©å¯æ§ (ATRæ­¢æŸ)
- âœ… ç›ˆäºæ¯”å¥½

**åŠ£åŠ¿**:
- âŒ å‡çªç ´é£é™©
- âŒ éœ€è¦æˆäº¤é‡ç¡®è®¤
- âŒ ç›˜æ•´æ—¶é—´é•¿

---

## ä½¿ç”¨ç­–ç•¥

### æ–¹æ³•1: ç›´æ¥ä½¿ç”¨

```python
from script.strategies.momentum import MomentumStrategy

# åˆ›å»ºç­–ç•¥
strategy = MomentumStrategy()

# åˆ†æå•åªè‚¡ç¥¨
signal = strategy.analyze('AAPL')

print(f"ä¿¡å·: {signal['signal']}")
print(f"è¯„åˆ†: {signal['score']}")
print(f"å…¥åœº: ${signal['entry_price']:.2f}")
print(f"æ­¢æŸ: ${signal['stop_loss']:.2f}")
print(f"æ­¢ç›ˆ: ${signal['take_profit']:.2f}")
print(f"ç†ç”±: {signal['reasons']}")
```

### æ–¹æ³•2: ä½¿ç”¨ç­–ç•¥ç®¡ç†å™¨

```python
from script.strategy_manager import StrategyManager

# åˆ›å»ºç®¡ç†å™¨
mgr = StrategyManager()

# åˆ—å‡ºæ‰€æœ‰ç­–ç•¥
mgr.list_strategies()

# è·å–ç­–ç•¥
strategy = mgr.get_strategy('momentum')
signal = strategy.analyze('AAPL')

# è‡ªå®šä¹‰å‚æ•°
strategy = mgr.get_strategy('momentum', params={
    'lookback_days': 30
})
```

### æ‰«æå¸‚åœº

```python
# ä½¿ç”¨å•ä¸ªç­–ç•¥æ‰«æ
strategy = MomentumStrategy()
signals = strategy.scan_market(
    filters={
        'min_score': 70,
        'signal_types': ['STRONG_BUY', 'BUY']
    }
)

print(f"å‘ç° {len(signals)} ä¸ªä¿¡å·")
for sig in signals[:10]:
    print(f"{sig['symbol']}: {sig['signal']} ({sig['score']}åˆ†)")
```

---

## è‡ªå®šä¹‰ç­–ç•¥

### æ­¥éª¤1: å¤åˆ¶æ¨¡æ¿

```bash
cd d:\strategy=Z\script\strategies
copy custom_template.py my_strategy.py
```

### æ­¥éª¤2: ç¼–è¾‘ç­–ç•¥

```python
# my_strategy.py
from script.strategy_base import BaseStrategy
import pandas as pd

class MyCustomStrategy(BaseStrategy):
    def __init__(self, params=None):
        default_params = {
            'my_param': 10,
            'capital': 2000,
            'position_pct': 0.35,
        }
        if params:
            default_params.update(params)

        super().__init__(name="My Custom Strategy", params=default_params)

    def analyze(self, symbol, df=None):
        # è·å–æ•°æ®
        if df is None:
            df = self.get_price_data(symbol, days=60)

        # è®¡ç®—ä½ çš„æŒ‡æ ‡
        latest_price = df.iloc[-1]['close']
        ma20 = df['close'].tail(20).mean()

        # è¯„åˆ†é€»è¾‘
        score = 50
        reasons = []

        if latest_price > ma20:
            score += 30
            reasons.append("ä»·æ ¼åœ¨MA20ä¸Šæ–¹")

        # æ·»åŠ æ›´å¤šè§„åˆ™...

        # ç¡®å®šä¿¡å·
        if score >= 70:
            signal = 'BUY'
        elif score >= 40:
            signal = 'HOLD'
        else:
            signal = 'SELL'

        # è¿”å›æ ‡å‡†æ ¼å¼
        return self.validate_signal({
            'symbol': symbol,
            'signal': signal,
            'score': score,
            'reasons': reasons,
            'entry_price': latest_price,
            'stop_loss': latest_price * 0.95,
            'take_profit': latest_price * 1.10,
            'position_size': int((self.params['capital'] * self.params['position_pct']) / latest_price),
            'metadata': {'ma20': ma20}
        })
```

### æ­¥éª¤3: ä½¿ç”¨è‡ªå®šä¹‰ç­–ç•¥

```python
from script.strategies.my_strategy import MyCustomStrategy

strategy = MyCustomStrategy()
signal = strategy.analyze('AAPL')
```

### å¯ç”¨çš„è¾…åŠ©æ–¹æ³•

```python
# è·å–æ—¥çº¿æ•°æ®
df = self.get_price_data(symbol, days=120)

# è·å–åˆ†é’Ÿæ•°æ®
df_intraday = self.get_intraday_data(symbol, interval='5m', days=7)

# è®¿é—®æ•°æ®åº“
self.db.get_latest_price(symbol)
self.db.get_price_history(symbol)

# è®¿é—®å‚æ•°
lookback = self.params['lookback_days']

# éªŒè¯ä¿¡å·
signal = self.validate_signal({...})
```

---

## ç­–ç•¥ç»„åˆ

### åˆ›å»ºç»„åˆ

```python
from script.strategy_manager import StrategyManager

mgr = StrategyManager()

# ç»„åˆ2ä¸ªç­–ç•¥ (åŠ¨é‡70%, å‡å€¼å›å½’30%)
combo = mgr.create_combo(
    ['momentum', 'mean_reversion'],
    weights=[0.7, 0.3]
)

# åˆ†æ
signal = combo.analyze('AAPL')
print(f"ç»¼åˆä¿¡å·: {signal['signal']} ({signal['score']}åˆ†)")
```

### é«˜çº§ç»„åˆ

```python
# ä½¿ç”¨è‡ªå®šä¹‰å‚æ•°
combo = mgr.create_combo(
    ['momentum', 'mean_reversion', 'breakout'],
    weights=[0.5, 0.3, 0.2],
    params_list=[
        {'lookback_days': 30},    # åŠ¨é‡ç­–ç•¥å‚æ•°
        {'rsi_oversold': 25},     # å‡å€¼å›å½’å‚æ•°
        {'consolidation_days': 15} # çªç ´ç­–ç•¥å‚æ•°
    ]
)
```

### ç»„åˆçš„ä¼˜åŠ¿

- âœ… **é™ä½é£é™©**: å¤šä¸ªç­–ç•¥äº’è¡¥
- âœ… **æé«˜ç¨³å®šæ€§**: ä¸ä¾èµ–å•ä¸€ç­–ç•¥
- âœ… **é€‚åº”ä¸åŒå¸‚åœº**: å„ç§å¸‚å†µéƒ½èƒ½åº”å¯¹

---

## ç­–ç•¥æ¯”è¾ƒ

### æ¯”è¾ƒå•åªè‚¡ç¥¨

```python
from script.strategy_manager import StrategyManager

mgr = StrategyManager()

# æ¯”è¾ƒæ‰€æœ‰ç­–ç•¥
df = mgr.compare_strategies('AAPL')
print(df)

# è¾“å‡º:
#      strategy         signal  score  risk_reward
#  momentum        STRONG_BUY     85         2.4
#  breakout               BUY     72         3.0
#  mean_reversion        HOLD     55         1.8
```

### æ¯”è¾ƒå¤šåªè‚¡ç¥¨

```python
symbols = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'NVDA']

for symbol in symbols:
    print(f"\n{symbol}:")
    df = mgr.compare_strategies(symbol)
    print(df[['strategy', 'signal', 'score']])
```

---

## é«˜çº§ç”¨æ³•

### 1. æ ¹æ®å¸‚åœºæ¨èç­–ç•¥

```python
mgr = StrategyManager()

# è¶‹åŠ¿å¸‚
mgr.recommend_strategy('trending')  # æ¨è: åŠ¨é‡ç­–ç•¥

# éœ‡è¡å¸‚
mgr.recommend_strategy('ranging')   # æ¨è: å‡å€¼å›å½’

# æ³¢åŠ¨å¸‚
mgr.recommend_strategy('volatile')  # æ¨è: çªç ´ç­–ç•¥
```

### 2. ç”¨æ‰€æœ‰ç­–ç•¥æ‰«æå¸‚åœº

```python
mgr = StrategyManager()

# æ‰«ææ‰€æœ‰è‚¡ç¥¨
results = mgr.scan_with_all_strategies(top_n=10)

# æŸ¥çœ‹å„ç­–ç•¥çš„Top 10
for strategy_name, signals in results.items():
    print(f"\n{strategy_name} Top 10:")
    for sig in signals:
        print(f"  {sig['symbol']}: {sig['score']}åˆ†")
```

### 3. é›†æˆåˆ°æ¯æ—¥æ›´æ–°

ä¿®æ”¹ `tools/daily_update.py`ï¼Œæ›¿æ¢åŠ¨é‡æ‰«æå™¨ï¼š

```python
from script.strategy_manager import StrategyManager

# åœ¨ DailyUpdater ç±»ä¸­
def run_daily_update(self):
    # ... å‰é¢çš„æ­¥éª¤ ...

    # Step 4: ä½¿ç”¨ç­–ç•¥ç®¡ç†å™¨
    mgr = StrategyManager()

    # é€‰æ‹©ç­–ç•¥ (å¯æ ¹æ®å¸‚åœºæƒ…å†µåŠ¨æ€é€‰æ‹©)
    strategy = mgr.get_strategy('momentum')  # æˆ– 'mean_reversion', 'breakout'

    # æˆ–ä½¿ç”¨ç»„åˆ
    # strategy = mgr.create_combo(['momentum', 'mean_reversion'])

    # æ‰«æå¸‚åœº
    signals = strategy.scan_market(filters={'min_score': 70})

    # ... åç»­æ­¥éª¤ ...
```

### 4. å‚æ•°ä¼˜åŒ– (æ‰‹åŠ¨)

```python
# æµ‹è¯•ä¸åŒå‚æ•°
param_sets = [
    {'lookback_days': 10, 'min_momentum': 5},
    {'lookback_days': 20, 'min_momentum': 10},
    {'lookback_days': 30, 'min_momentum': 15},
]

results = []
for params in param_sets:
    strategy = MomentumStrategy(params=params)
    signal = strategy.analyze('AAPL')
    results.append({
        'params': params,
        'score': signal['score']
    })

# æ‰¾åˆ°æœ€ä½³å‚æ•°
best = max(results, key=lambda x: x['score'])
print(f"æœ€ä½³å‚æ•°: {best['params']}")
```

---

## ç­–ç•¥é€‰æ‹©å†³ç­–æ ‘

```
å¸‚åœºè¶‹åŠ¿æ˜æ˜¾?
â”œâ”€ æ˜¯ â†’ ä¸Šå‡è¶‹åŠ¿?
â”‚       â”œâ”€ æ˜¯ â†’ åŠ¨é‡ç­–ç•¥ â­
â”‚       â””â”€ å¦ â†’ å‡å€¼å›å½’ç­–ç•¥
â””â”€ å¦ â†’ æ¨ªç›˜æ•´ç†?
        â”œâ”€ æ˜¯ â†’ çªç ´ç­–ç•¥ â­
        â””â”€ å¦ â†’ ç­–ç•¥ç»„åˆ â­â­â­
```

## æœ€ä½³å®è·µ

### âœ… DO (æ¨èåšæ³•)

1. **å¤šç­–ç•¥éªŒè¯**: ç”¨å¤šä¸ªç­–ç•¥åˆ†æåŒä¸€è‚¡ç¥¨ï¼Œç»¼åˆåˆ¤æ–­
2. **å‚æ•°è°ƒæ•´**: æ ¹æ®ä½ çš„èµ„é‡‘å’Œé£é™©åå¥½è°ƒæ•´å‚æ•°
3. **å›æµ‹éªŒè¯**: ç”¨å†å²æ•°æ®éªŒè¯ç­–ç•¥æœ‰æ•ˆæ€§ (åŠŸèƒ½å¼€å‘ä¸­)
4. **ç»„åˆä½¿ç”¨**: å¸‚åœºä¸ç¡®å®šæ—¶ä½¿ç”¨ç­–ç•¥ç»„åˆ
5. **åŠ¨æ€åˆ‡æ¢**: æ ¹æ®å¸‚åœºå˜åŒ–åˆ‡æ¢ç­–ç•¥

### âŒ DON'T (é¿å…åšæ³•)

1. **ç›²ç›®è·Ÿéš**: ä¸è¦ç›²ç›®è·Ÿéšä»»ä½•å•ä¸€ç­–ç•¥
2. **è¿‡åº¦ä¼˜åŒ–**: ä¸è¦è¿‡åº¦æ‹Ÿåˆå†å²æ•°æ®
3. **å¿½ç•¥æ­¢æŸ**: ç­–ç•¥ç»™å‡ºçš„æ­¢æŸä½å¿…é¡»ä¸¥æ ¼æ‰§è¡Œ
4. **é¢‘ç¹åˆ‡æ¢**: ä¸è¦é¢‘ç¹æ›´æ¢ç­–ç•¥
5. **å¿½ç•¥å¸‚åœº**: ç­–ç•¥åªæ˜¯è¾…åŠ©ï¼Œè¦ç»“åˆå¸‚åœºåˆ¤æ–­

---

## æ•…éšœæ’é™¤

### Q: ç­–ç•¥æŠ¥é”™ "Insufficient data"

**A**: è‚¡ç¥¨å†å²æ•°æ®ä¸è¶³ï¼Œè‡³å°‘éœ€è¦20-60å¤©æ•°æ®ã€‚æ£€æŸ¥æ•°æ®åº“æˆ–æ›´æ¢è‚¡ç¥¨ã€‚

### Q: æ‰€æœ‰ç­–ç•¥éƒ½æ˜¾ç¤º HOLD

**A**: å½“å‰å¸‚åœºæ²¡æœ‰æ˜ç¡®æœºä¼šï¼Œæˆ–å‚æ•°è®¾ç½®è¿‡äºä¸¥æ ¼ã€‚å°è¯•é™ä½ `min_score` æˆ–è°ƒæ•´å…¶ä»–å‚æ•°ã€‚

### Q: å¦‚ä½•çŸ¥é“å“ªä¸ªç­–ç•¥æœ€å¥½ï¼Ÿ

**A**: ä½¿ç”¨ `compare_strategies()` æ¯”è¾ƒï¼Œæˆ–æ ¹æ®å¸‚åœºæƒ…å†µé€‰æ‹©ï¼š
- ç‰›å¸‚ â†’ åŠ¨é‡
- éœ‡è¡ â†’ å‡å€¼å›å½’
- ç›˜æ•´ â†’ çªç ´
- ä¸ç¡®å®š â†’ ç»„åˆ

### Q: å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªç­–ç•¥å—ï¼Ÿ

**A**: å¯ä»¥ï¼ä½¿ç”¨ç­–ç•¥ç»„åˆ (`create_combo`) æˆ–æ‰‹åŠ¨æ¯”è¾ƒç»“æœã€‚

---

## æ‰©å±•é˜…è¯»

- [å°èµ„é‡‘åŠ¨é‡äº¤æ˜“æŒ‡å—](å°èµ„é‡‘åŠ¨é‡äº¤æ˜“æŒ‡å—.md) - åŠ¨é‡ç­–ç•¥è¯¦è§£
- [ä½¿ç”¨æŒ‡å—](ä½¿ç”¨æŒ‡å—.md) - ç³»ç»ŸåŸºç¡€ä½¿ç”¨
- [IMPLEMENTATION_SUMMARY.md](../IMPLEMENTATION_SUMMARY.md) - æŠ€æœ¯å®ç°ç»†èŠ‚

---

**æœ€åæ›´æ–°**: 2025-12-29
**ç‰ˆæœ¬**: 1.0.0
